library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;

entity regfile32 is port
(
	CLK		: in std_logic;
	INST		: in std_logic_vector(31 downto 0);
	RegDst	: out std_logic_vector(31 downto 0);
	RegWrite	: out std_logic_vector(31 downto 0);
	AluSrc	: out std_logic_vector(31 downto 0);
	MemWrite	: out std_logic_vector(31 downto 0);
	MemToReg	: out std_logic_vector(31 downto 0)
);
end regfile32;

architecture behavior of regfile32 is 
type reg_array is
	array (0 to 31) of std_logic_vector(31 downto 0);
signal regs : reg_array;
begin
	process(clk)
	begin
		if rising_edge(clk) then
			if rst = '1' then
				regs <= (others => (others => '0'));
			elsif RegWrite = '1' then
				if w_addr /= "00000" then
					regs(to_integer(unsigned(w_addr))) <= w_data;
				end if;
			end if;
		end if;
	end process;

	r_data1 <= (others => '0') when r_addr1 = "00000" else regs(to_integer(unsigned(r_addr1)));
	r_data2 <= (others => '0') when r_addr2 = "00000" else regs(to_integer(unsigned(r_addr2)));

end behavior;
